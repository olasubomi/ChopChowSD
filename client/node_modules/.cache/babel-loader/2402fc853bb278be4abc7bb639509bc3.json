{"ast":null,"code":"import { __values } from \"tslib\";\nimport { fromHex, toHex } from \"@aws-sdk/util-hex-encoding\";\nimport { Int64 } from \"./Int64\";\n\nvar HeaderMarshaller = function () {\n  function HeaderMarshaller(toUtf8, fromUtf8) {\n    this.toUtf8 = toUtf8;\n    this.fromUtf8 = fromUtf8;\n  }\n\n  HeaderMarshaller.prototype.format = function (headers) {\n    var e_1, _a, e_2, _b;\n\n    var chunks = [];\n\n    try {\n      for (var _c = __values(Object.keys(headers)), _d = _c.next(); !_d.done; _d = _c.next()) {\n        var headerName = _d.value;\n        var bytes = this.fromUtf8(headerName);\n        chunks.push(Uint8Array.from([bytes.byteLength]), bytes, this.formatHeaderValue(headers[headerName]));\n      }\n    } catch (e_1_1) {\n      e_1 = {\n        error: e_1_1\n      };\n    } finally {\n      try {\n        if (_d && !_d.done && (_a = _c.return)) _a.call(_c);\n      } finally {\n        if (e_1) throw e_1.error;\n      }\n    }\n\n    var out = new Uint8Array(chunks.reduce(function (carry, bytes) {\n      return carry + bytes.byteLength;\n    }, 0));\n    var position = 0;\n\n    try {\n      for (var chunks_1 = __values(chunks), chunks_1_1 = chunks_1.next(); !chunks_1_1.done; chunks_1_1 = chunks_1.next()) {\n        var chunk = chunks_1_1.value;\n        out.set(chunk, position);\n        position += chunk.byteLength;\n      }\n    } catch (e_2_1) {\n      e_2 = {\n        error: e_2_1\n      };\n    } finally {\n      try {\n        if (chunks_1_1 && !chunks_1_1.done && (_b = chunks_1.return)) _b.call(chunks_1);\n      } finally {\n        if (e_2) throw e_2.error;\n      }\n    }\n\n    return out;\n  };\n\n  HeaderMarshaller.prototype.formatHeaderValue = function (header) {\n    switch (header.type) {\n      case \"boolean\":\n        return Uint8Array.from([header.value ? 0 : 1]);\n\n      case \"byte\":\n        return Uint8Array.from([2, header.value]);\n\n      case \"short\":\n        var shortView = new DataView(new ArrayBuffer(3));\n        shortView.setUint8(0, 3);\n        shortView.setInt16(1, header.value, false);\n        return new Uint8Array(shortView.buffer);\n\n      case \"integer\":\n        var intView = new DataView(new ArrayBuffer(5));\n        intView.setUint8(0, 4);\n        intView.setInt32(1, header.value, false);\n        return new Uint8Array(intView.buffer);\n\n      case \"long\":\n        var longBytes = new Uint8Array(9);\n        longBytes[0] = 5;\n        longBytes.set(header.value.bytes, 1);\n        return longBytes;\n\n      case \"binary\":\n        var binView = new DataView(new ArrayBuffer(3 + header.value.byteLength));\n        binView.setUint8(0, 6);\n        binView.setUint16(1, header.value.byteLength, false);\n        var binBytes = new Uint8Array(binView.buffer);\n        binBytes.set(header.value, 3);\n        return binBytes;\n\n      case \"string\":\n        var utf8Bytes = this.fromUtf8(header.value);\n        var strView = new DataView(new ArrayBuffer(3 + utf8Bytes.byteLength));\n        strView.setUint8(0, 7);\n        strView.setUint16(1, utf8Bytes.byteLength, false);\n        var strBytes = new Uint8Array(strView.buffer);\n        strBytes.set(utf8Bytes, 3);\n        return strBytes;\n\n      case \"timestamp\":\n        var tsBytes = new Uint8Array(9);\n        tsBytes[0] = 8;\n        tsBytes.set(Int64.fromNumber(header.value.valueOf()).bytes, 1);\n        return tsBytes;\n\n      case \"uuid\":\n        if (!UUID_PATTERN.test(header.value)) {\n          throw new Error(\"Invalid UUID received: \".concat(header.value));\n        }\n\n        var uuidBytes = new Uint8Array(17);\n        uuidBytes[0] = 9;\n        uuidBytes.set(fromHex(header.value.replace(/\\-/g, \"\")), 1);\n        return uuidBytes;\n    }\n  };\n\n  HeaderMarshaller.prototype.parse = function (headers) {\n    var out = {};\n    var position = 0;\n\n    while (position < headers.byteLength) {\n      var nameLength = headers.getUint8(position++);\n      var name = this.toUtf8(new Uint8Array(headers.buffer, headers.byteOffset + position, nameLength));\n      position += nameLength;\n\n      switch (headers.getUint8(position++)) {\n        case 0:\n          out[name] = {\n            type: BOOLEAN_TAG,\n            value: true\n          };\n          break;\n\n        case 1:\n          out[name] = {\n            type: BOOLEAN_TAG,\n            value: false\n          };\n          break;\n\n        case 2:\n          out[name] = {\n            type: BYTE_TAG,\n            value: headers.getInt8(position++)\n          };\n          break;\n\n        case 3:\n          out[name] = {\n            type: SHORT_TAG,\n            value: headers.getInt16(position, false)\n          };\n          position += 2;\n          break;\n\n        case 4:\n          out[name] = {\n            type: INT_TAG,\n            value: headers.getInt32(position, false)\n          };\n          position += 4;\n          break;\n\n        case 5:\n          out[name] = {\n            type: LONG_TAG,\n            value: new Int64(new Uint8Array(headers.buffer, headers.byteOffset + position, 8))\n          };\n          position += 8;\n          break;\n\n        case 6:\n          var binaryLength = headers.getUint16(position, false);\n          position += 2;\n          out[name] = {\n            type: BINARY_TAG,\n            value: new Uint8Array(headers.buffer, headers.byteOffset + position, binaryLength)\n          };\n          position += binaryLength;\n          break;\n\n        case 7:\n          var stringLength = headers.getUint16(position, false);\n          position += 2;\n          out[name] = {\n            type: STRING_TAG,\n            value: this.toUtf8(new Uint8Array(headers.buffer, headers.byteOffset + position, stringLength))\n          };\n          position += stringLength;\n          break;\n\n        case 8:\n          out[name] = {\n            type: TIMESTAMP_TAG,\n            value: new Date(new Int64(new Uint8Array(headers.buffer, headers.byteOffset + position, 8)).valueOf())\n          };\n          position += 8;\n          break;\n\n        case 9:\n          var uuidBytes = new Uint8Array(headers.buffer, headers.byteOffset + position, 16);\n          position += 16;\n          out[name] = {\n            type: UUID_TAG,\n            value: \"\".concat(toHex(uuidBytes.subarray(0, 4)), \"-\").concat(toHex(uuidBytes.subarray(4, 6)), \"-\").concat(toHex(uuidBytes.subarray(6, 8)), \"-\").concat(toHex(uuidBytes.subarray(8, 10)), \"-\").concat(toHex(uuidBytes.subarray(10)))\n          };\n          break;\n\n        default:\n          throw new Error(\"Unrecognized header type tag\");\n      }\n    }\n\n    return out;\n  };\n\n  return HeaderMarshaller;\n}();\n\nexport { HeaderMarshaller };\nvar HEADER_VALUE_TYPE;\n\n(function (HEADER_VALUE_TYPE) {\n  HEADER_VALUE_TYPE[HEADER_VALUE_TYPE[\"boolTrue\"] = 0] = \"boolTrue\";\n  HEADER_VALUE_TYPE[HEADER_VALUE_TYPE[\"boolFalse\"] = 1] = \"boolFalse\";\n  HEADER_VALUE_TYPE[HEADER_VALUE_TYPE[\"byte\"] = 2] = \"byte\";\n  HEADER_VALUE_TYPE[HEADER_VALUE_TYPE[\"short\"] = 3] = \"short\";\n  HEADER_VALUE_TYPE[HEADER_VALUE_TYPE[\"integer\"] = 4] = \"integer\";\n  HEADER_VALUE_TYPE[HEADER_VALUE_TYPE[\"long\"] = 5] = \"long\";\n  HEADER_VALUE_TYPE[HEADER_VALUE_TYPE[\"byteArray\"] = 6] = \"byteArray\";\n  HEADER_VALUE_TYPE[HEADER_VALUE_TYPE[\"string\"] = 7] = \"string\";\n  HEADER_VALUE_TYPE[HEADER_VALUE_TYPE[\"timestamp\"] = 8] = \"timestamp\";\n  HEADER_VALUE_TYPE[HEADER_VALUE_TYPE[\"uuid\"] = 9] = \"uuid\";\n})(HEADER_VALUE_TYPE || (HEADER_VALUE_TYPE = {}));\n\nvar BOOLEAN_TAG = \"boolean\";\nvar BYTE_TAG = \"byte\";\nvar SHORT_TAG = \"short\";\nvar INT_TAG = \"integer\";\nvar LONG_TAG = \"long\";\nvar BINARY_TAG = \"binary\";\nvar STRING_TAG = \"string\";\nvar TIMESTAMP_TAG = \"timestamp\";\nvar UUID_TAG = \"uuid\";\nvar UUID_PATTERN = /^[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}$/;","map":{"version":3,"sources":["/home/chuka/joe/ChopChowSD/node_modules/@aws-sdk/eventstream-marshaller/dist-es/HeaderMarshaller.js"],"names":["__values","fromHex","toHex","Int64","HeaderMarshaller","toUtf8","fromUtf8","prototype","format","headers","e_1","_a","e_2","_b","chunks","_c","Object","keys","_d","next","done","headerName","value","bytes","push","Uint8Array","from","byteLength","formatHeaderValue","e_1_1","error","return","call","out","reduce","carry","position","chunks_1","chunks_1_1","chunk","set","e_2_1","header","type","shortView","DataView","ArrayBuffer","setUint8","setInt16","buffer","intView","setInt32","longBytes","binView","setUint16","binBytes","utf8Bytes","strView","strBytes","tsBytes","fromNumber","valueOf","UUID_PATTERN","test","Error","concat","uuidBytes","replace","parse","nameLength","getUint8","name","byteOffset","BOOLEAN_TAG","BYTE_TAG","getInt8","SHORT_TAG","getInt16","INT_TAG","getInt32","LONG_TAG","binaryLength","getUint16","BINARY_TAG","stringLength","STRING_TAG","TIMESTAMP_TAG","Date","UUID_TAG","subarray","HEADER_VALUE_TYPE"],"mappings":"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","sourcesContent":["import { __values } from \"tslib\";\nimport { fromHex, toHex } from \"@aws-sdk/util-hex-encoding\";\nimport { Int64 } from \"./Int64\";\nvar HeaderMarshaller = (function () {\n    function HeaderMarshaller(toUtf8, fromUtf8) {\n        this.toUtf8 = toUtf8;\n        this.fromUtf8 = fromUtf8;\n    }\n    HeaderMarshaller.prototype.format = function (headers) {\n        var e_1, _a, e_2, _b;\n        var chunks = [];\n        try {\n            for (var _c = __values(Object.keys(headers)), _d = _c.next(); !_d.done; _d = _c.next()) {\n                var headerName = _d.value;\n                var bytes = this.fromUtf8(headerName);\n                chunks.push(Uint8Array.from([bytes.byteLength]), bytes, this.formatHeaderValue(headers[headerName]));\n            }\n        }\n        catch (e_1_1) { e_1 = { error: e_1_1 }; }\n        finally {\n            try {\n                if (_d && !_d.done && (_a = _c.return)) _a.call(_c);\n            }\n            finally { if (e_1) throw e_1.error; }\n        }\n        var out = new Uint8Array(chunks.reduce(function (carry, bytes) { return carry + bytes.byteLength; }, 0));\n        var position = 0;\n        try {\n            for (var chunks_1 = __values(chunks), chunks_1_1 = chunks_1.next(); !chunks_1_1.done; chunks_1_1 = chunks_1.next()) {\n                var chunk = chunks_1_1.value;\n                out.set(chunk, position);\n                position += chunk.byteLength;\n            }\n        }\n        catch (e_2_1) { e_2 = { error: e_2_1 }; }\n        finally {\n            try {\n                if (chunks_1_1 && !chunks_1_1.done && (_b = chunks_1.return)) _b.call(chunks_1);\n            }\n            finally { if (e_2) throw e_2.error; }\n        }\n        return out;\n    };\n    HeaderMarshaller.prototype.formatHeaderValue = function (header) {\n        switch (header.type) {\n            case \"boolean\":\n                return Uint8Array.from([header.value ? 0 : 1]);\n            case \"byte\":\n                return Uint8Array.from([2, header.value]);\n            case \"short\":\n                var shortView = new DataView(new ArrayBuffer(3));\n                shortView.setUint8(0, 3);\n                shortView.setInt16(1, header.value, false);\n                return new Uint8Array(shortView.buffer);\n            case \"integer\":\n                var intView = new DataView(new ArrayBuffer(5));\n                intView.setUint8(0, 4);\n                intView.setInt32(1, header.value, false);\n                return new Uint8Array(intView.buffer);\n            case \"long\":\n                var longBytes = new Uint8Array(9);\n                longBytes[0] = 5;\n                longBytes.set(header.value.bytes, 1);\n                return longBytes;\n            case \"binary\":\n                var binView = new DataView(new ArrayBuffer(3 + header.value.byteLength));\n                binView.setUint8(0, 6);\n                binView.setUint16(1, header.value.byteLength, false);\n                var binBytes = new Uint8Array(binView.buffer);\n                binBytes.set(header.value, 3);\n                return binBytes;\n            case \"string\":\n                var utf8Bytes = this.fromUtf8(header.value);\n                var strView = new DataView(new ArrayBuffer(3 + utf8Bytes.byteLength));\n                strView.setUint8(0, 7);\n                strView.setUint16(1, utf8Bytes.byteLength, false);\n                var strBytes = new Uint8Array(strView.buffer);\n                strBytes.set(utf8Bytes, 3);\n                return strBytes;\n            case \"timestamp\":\n                var tsBytes = new Uint8Array(9);\n                tsBytes[0] = 8;\n                tsBytes.set(Int64.fromNumber(header.value.valueOf()).bytes, 1);\n                return tsBytes;\n            case \"uuid\":\n                if (!UUID_PATTERN.test(header.value)) {\n                    throw new Error(\"Invalid UUID received: \".concat(header.value));\n                }\n                var uuidBytes = new Uint8Array(17);\n                uuidBytes[0] = 9;\n                uuidBytes.set(fromHex(header.value.replace(/\\-/g, \"\")), 1);\n                return uuidBytes;\n        }\n    };\n    HeaderMarshaller.prototype.parse = function (headers) {\n        var out = {};\n        var position = 0;\n        while (position < headers.byteLength) {\n            var nameLength = headers.getUint8(position++);\n            var name = this.toUtf8(new Uint8Array(headers.buffer, headers.byteOffset + position, nameLength));\n            position += nameLength;\n            switch (headers.getUint8(position++)) {\n                case 0:\n                    out[name] = {\n                        type: BOOLEAN_TAG,\n                        value: true,\n                    };\n                    break;\n                case 1:\n                    out[name] = {\n                        type: BOOLEAN_TAG,\n                        value: false,\n                    };\n                    break;\n                case 2:\n                    out[name] = {\n                        type: BYTE_TAG,\n                        value: headers.getInt8(position++),\n                    };\n                    break;\n                case 3:\n                    out[name] = {\n                        type: SHORT_TAG,\n                        value: headers.getInt16(position, false),\n                    };\n                    position += 2;\n                    break;\n                case 4:\n                    out[name] = {\n                        type: INT_TAG,\n                        value: headers.getInt32(position, false),\n                    };\n                    position += 4;\n                    break;\n                case 5:\n                    out[name] = {\n                        type: LONG_TAG,\n                        value: new Int64(new Uint8Array(headers.buffer, headers.byteOffset + position, 8)),\n                    };\n                    position += 8;\n                    break;\n                case 6:\n                    var binaryLength = headers.getUint16(position, false);\n                    position += 2;\n                    out[name] = {\n                        type: BINARY_TAG,\n                        value: new Uint8Array(headers.buffer, headers.byteOffset + position, binaryLength),\n                    };\n                    position += binaryLength;\n                    break;\n                case 7:\n                    var stringLength = headers.getUint16(position, false);\n                    position += 2;\n                    out[name] = {\n                        type: STRING_TAG,\n                        value: this.toUtf8(new Uint8Array(headers.buffer, headers.byteOffset + position, stringLength)),\n                    };\n                    position += stringLength;\n                    break;\n                case 8:\n                    out[name] = {\n                        type: TIMESTAMP_TAG,\n                        value: new Date(new Int64(new Uint8Array(headers.buffer, headers.byteOffset + position, 8)).valueOf()),\n                    };\n                    position += 8;\n                    break;\n                case 9:\n                    var uuidBytes = new Uint8Array(headers.buffer, headers.byteOffset + position, 16);\n                    position += 16;\n                    out[name] = {\n                        type: UUID_TAG,\n                        value: \"\".concat(toHex(uuidBytes.subarray(0, 4)), \"-\").concat(toHex(uuidBytes.subarray(4, 6)), \"-\").concat(toHex(uuidBytes.subarray(6, 8)), \"-\").concat(toHex(uuidBytes.subarray(8, 10)), \"-\").concat(toHex(uuidBytes.subarray(10))),\n                    };\n                    break;\n                default:\n                    throw new Error(\"Unrecognized header type tag\");\n            }\n        }\n        return out;\n    };\n    return HeaderMarshaller;\n}());\nexport { HeaderMarshaller };\nvar HEADER_VALUE_TYPE;\n(function (HEADER_VALUE_TYPE) {\n    HEADER_VALUE_TYPE[HEADER_VALUE_TYPE[\"boolTrue\"] = 0] = \"boolTrue\";\n    HEADER_VALUE_TYPE[HEADER_VALUE_TYPE[\"boolFalse\"] = 1] = \"boolFalse\";\n    HEADER_VALUE_TYPE[HEADER_VALUE_TYPE[\"byte\"] = 2] = \"byte\";\n    HEADER_VALUE_TYPE[HEADER_VALUE_TYPE[\"short\"] = 3] = \"short\";\n    HEADER_VALUE_TYPE[HEADER_VALUE_TYPE[\"integer\"] = 4] = \"integer\";\n    HEADER_VALUE_TYPE[HEADER_VALUE_TYPE[\"long\"] = 5] = \"long\";\n    HEADER_VALUE_TYPE[HEADER_VALUE_TYPE[\"byteArray\"] = 6] = \"byteArray\";\n    HEADER_VALUE_TYPE[HEADER_VALUE_TYPE[\"string\"] = 7] = \"string\";\n    HEADER_VALUE_TYPE[HEADER_VALUE_TYPE[\"timestamp\"] = 8] = \"timestamp\";\n    HEADER_VALUE_TYPE[HEADER_VALUE_TYPE[\"uuid\"] = 9] = \"uuid\";\n})(HEADER_VALUE_TYPE || (HEADER_VALUE_TYPE = {}));\nvar BOOLEAN_TAG = \"boolean\";\nvar BYTE_TAG = \"byte\";\nvar SHORT_TAG = \"short\";\nvar INT_TAG = \"integer\";\nvar LONG_TAG = \"long\";\nvar BINARY_TAG = \"binary\";\nvar STRING_TAG = \"string\";\nvar TIMESTAMP_TAG = \"timestamp\";\nvar UUID_TAG = \"uuid\";\nvar UUID_PATTERN = /^[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}$/;\n"]},"metadata":{},"sourceType":"module"}