{"ast":null,"code":"import { __awaiter, __generator } from \"tslib\";\nimport { fromBase64 } from \"@aws-sdk/util-base64-browser\";\nexport var streamCollector = function streamCollector(stream) {\n  if (typeof Blob === \"function\" && stream instanceof Blob) {\n    return collectBlob(stream);\n  }\n\n  return collectStream(stream);\n};\n\nfunction collectBlob(blob) {\n  return __awaiter(this, void 0, void 0, function () {\n    var base64, arrayBuffer;\n    return __generator(this, function (_a) {\n      switch (_a.label) {\n        case 0:\n          return [4, readToBase64(blob)];\n\n        case 1:\n          base64 = _a.sent();\n          arrayBuffer = fromBase64(base64);\n          return [2, new Uint8Array(arrayBuffer)];\n      }\n    });\n  });\n}\n\nfunction collectStream(stream) {\n  return __awaiter(this, void 0, void 0, function () {\n    var res, reader, isDone, _a, done, value, prior;\n\n    return __generator(this, function (_b) {\n      switch (_b.label) {\n        case 0:\n          res = new Uint8Array(0);\n          reader = stream.getReader();\n          isDone = false;\n          _b.label = 1;\n\n        case 1:\n          if (!!isDone) return [3, 3];\n          return [4, reader.read()];\n\n        case 2:\n          _a = _b.sent(), done = _a.done, value = _a.value;\n\n          if (value) {\n            prior = res;\n            res = new Uint8Array(prior.length + value.length);\n            res.set(prior);\n            res.set(value, prior.length);\n          }\n\n          isDone = done;\n          return [3, 1];\n\n        case 3:\n          return [2, res];\n      }\n    });\n  });\n}\n\nfunction readToBase64(blob) {\n  return new Promise(function (resolve, reject) {\n    var reader = new FileReader();\n\n    reader.onloadend = function () {\n      var _a;\n\n      if (reader.readyState !== 2) {\n        return reject(new Error(\"Reader aborted too early\"));\n      }\n\n      var result = (_a = reader.result) !== null && _a !== void 0 ? _a : \"\";\n      var commaIndex = result.indexOf(\",\");\n      var dataOffset = commaIndex > -1 ? commaIndex + 1 : result.length;\n      resolve(result.substring(dataOffset));\n    };\n\n    reader.onabort = function () {\n      return reject(new Error(\"Read aborted\"));\n    };\n\n    reader.onerror = function () {\n      return reject(reader.error);\n    };\n\n    reader.readAsDataURL(blob);\n  });\n}","map":{"version":3,"sources":["/home/chuka/joe/ChopChowSD/node_modules/@aws-sdk/fetch-http-handler/dist-es/stream-collector.js"],"names":["__awaiter","__generator","fromBase64","streamCollector","stream","Blob","collectBlob","collectStream","blob","base64","arrayBuffer","_a","label","readToBase64","sent","Uint8Array","res","reader","isDone","done","value","prior","_b","getReader","read","length","set","Promise","resolve","reject","FileReader","onloadend","readyState","Error","result","commaIndex","indexOf","dataOffset","substring","onabort","onerror","error","readAsDataURL"],"mappings":"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","sourcesContent":["import { __awaiter, __generator } from \"tslib\";\nimport { fromBase64 } from \"@aws-sdk/util-base64-browser\";\nexport var streamCollector = function (stream) {\n    if (typeof Blob === \"function\" && stream instanceof Blob) {\n        return collectBlob(stream);\n    }\n    return collectStream(stream);\n};\nfunction collectBlob(blob) {\n    return __awaiter(this, void 0, void 0, function () {\n        var base64, arrayBuffer;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0: return [4, readToBase64(blob)];\n                case 1:\n                    base64 = _a.sent();\n                    arrayBuffer = fromBase64(base64);\n                    return [2, new Uint8Array(arrayBuffer)];\n            }\n        });\n    });\n}\nfunction collectStream(stream) {\n    return __awaiter(this, void 0, void 0, function () {\n        var res, reader, isDone, _a, done, value, prior;\n        return __generator(this, function (_b) {\n            switch (_b.label) {\n                case 0:\n                    res = new Uint8Array(0);\n                    reader = stream.getReader();\n                    isDone = false;\n                    _b.label = 1;\n                case 1:\n                    if (!!isDone) return [3, 3];\n                    return [4, reader.read()];\n                case 2:\n                    _a = _b.sent(), done = _a.done, value = _a.value;\n                    if (value) {\n                        prior = res;\n                        res = new Uint8Array(prior.length + value.length);\n                        res.set(prior);\n                        res.set(value, prior.length);\n                    }\n                    isDone = done;\n                    return [3, 1];\n                case 3: return [2, res];\n            }\n        });\n    });\n}\nfunction readToBase64(blob) {\n    return new Promise(function (resolve, reject) {\n        var reader = new FileReader();\n        reader.onloadend = function () {\n            var _a;\n            if (reader.readyState !== 2) {\n                return reject(new Error(\"Reader aborted too early\"));\n            }\n            var result = ((_a = reader.result) !== null && _a !== void 0 ? _a : \"\");\n            var commaIndex = result.indexOf(\",\");\n            var dataOffset = commaIndex > -1 ? commaIndex + 1 : result.length;\n            resolve(result.substring(dataOffset));\n        };\n        reader.onabort = function () { return reject(new Error(\"Read aborted\")); };\n        reader.onerror = function () { return reject(reader.error); };\n        reader.readAsDataURL(blob);\n    });\n}\n"]},"metadata":{},"sourceType":"module"}