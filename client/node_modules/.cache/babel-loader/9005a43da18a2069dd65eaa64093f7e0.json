{"ast":null,"code":"import { __assign, __awaiter, __generator, __read, __spreadArray } from \"tslib\";\nimport { HttpRequest } from \"@aws-sdk/protocol-http\";\nimport { SPACE, UA_ESCAPE_REGEX, USER_AGENT, X_AMZ_USER_AGENT } from \"./constants\";\nexport var userAgentMiddleware = function userAgentMiddleware(options) {\n  return function (next, context) {\n    return function (args) {\n      return __awaiter(void 0, void 0, void 0, function () {\n        var request, headers, userAgent, defaultUserAgent, customUserAgent, sdkUserAgentValue, normalUAValue;\n\n        var _a, _b;\n\n        return __generator(this, function (_c) {\n          switch (_c.label) {\n            case 0:\n              request = args.request;\n              if (!HttpRequest.isInstance(request)) return [2, next(args)];\n              headers = request.headers;\n              userAgent = ((_a = context === null || context === void 0 ? void 0 : context.userAgent) === null || _a === void 0 ? void 0 : _a.map(escapeUserAgent)) || [];\n              return [4, options.defaultUserAgentProvider()];\n\n            case 1:\n              defaultUserAgent = _c.sent().map(escapeUserAgent);\n              customUserAgent = ((_b = options === null || options === void 0 ? void 0 : options.customUserAgent) === null || _b === void 0 ? void 0 : _b.map(escapeUserAgent)) || [];\n              sdkUserAgentValue = __spreadArray(__spreadArray(__spreadArray([], __read(defaultUserAgent), false), __read(userAgent), false), __read(customUserAgent), false).join(SPACE);\n              normalUAValue = __spreadArray(__spreadArray([], __read(defaultUserAgent.filter(function (section) {\n                return section.startsWith(\"aws-sdk-\");\n              })), false), __read(customUserAgent), false).join(SPACE);\n\n              if (options.runtime !== \"browser\") {\n                if (normalUAValue) {\n                  headers[X_AMZ_USER_AGENT] = headers[X_AMZ_USER_AGENT] ? \"\".concat(headers[USER_AGENT], \" \").concat(normalUAValue) : normalUAValue;\n                }\n\n                headers[USER_AGENT] = sdkUserAgentValue;\n              } else {\n                headers[X_AMZ_USER_AGENT] = sdkUserAgentValue;\n              }\n\n              return [2, next(__assign(__assign({}, args), {\n                request: request\n              }))];\n          }\n        });\n      });\n    };\n  };\n};\n\nvar escapeUserAgent = function escapeUserAgent(_a) {\n  var _b = __read(_a, 2),\n      name = _b[0],\n      version = _b[1];\n\n  var prefixSeparatorIndex = name.indexOf(\"/\");\n  var prefix = name.substring(0, prefixSeparatorIndex);\n  var uaName = name.substring(prefixSeparatorIndex + 1);\n\n  if (prefix === \"api\") {\n    uaName = uaName.toLowerCase();\n  }\n\n  return [prefix, uaName, version].filter(function (item) {\n    return item && item.length > 0;\n  }).map(function (item) {\n    return item === null || item === void 0 ? void 0 : item.replace(UA_ESCAPE_REGEX, \"_\");\n  }).join(\"/\");\n};\n\nexport var getUserAgentMiddlewareOptions = {\n  name: \"getUserAgentMiddleware\",\n  step: \"build\",\n  priority: \"low\",\n  tags: [\"SET_USER_AGENT\", \"USER_AGENT\"],\n  override: true\n};\nexport var getUserAgentPlugin = function getUserAgentPlugin(config) {\n  return {\n    applyToStack: function applyToStack(clientStack) {\n      clientStack.add(userAgentMiddleware(config), getUserAgentMiddlewareOptions);\n    }\n  };\n};","map":{"version":3,"sources":["/home/chuka/joe/ChopChowSD/node_modules/@aws-sdk/middleware-user-agent/dist-es/user-agent-middleware.js"],"names":["__assign","__awaiter","__generator","__read","__spreadArray","HttpRequest","SPACE","UA_ESCAPE_REGEX","USER_AGENT","X_AMZ_USER_AGENT","userAgentMiddleware","options","next","context","args","request","headers","userAgent","defaultUserAgent","customUserAgent","sdkUserAgentValue","normalUAValue","_a","_b","_c","label","isInstance","map","escapeUserAgent","defaultUserAgentProvider","sent","join","filter","section","startsWith","runtime","concat","name","version","prefixSeparatorIndex","indexOf","prefix","substring","uaName","toLowerCase","item","length","replace","getUserAgentMiddlewareOptions","step","priority","tags","override","getUserAgentPlugin","config","applyToStack","clientStack","add"],"mappings":"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","sourcesContent":["import { __assign, __awaiter, __generator, __read, __spreadArray } from \"tslib\";\nimport { HttpRequest } from \"@aws-sdk/protocol-http\";\nimport { SPACE, UA_ESCAPE_REGEX, USER_AGENT, X_AMZ_USER_AGENT } from \"./constants\";\nexport var userAgentMiddleware = function (options) {\n    return function (next, context) {\n        return function (args) { return __awaiter(void 0, void 0, void 0, function () {\n            var request, headers, userAgent, defaultUserAgent, customUserAgent, sdkUserAgentValue, normalUAValue;\n            var _a, _b;\n            return __generator(this, function (_c) {\n                switch (_c.label) {\n                    case 0:\n                        request = args.request;\n                        if (!HttpRequest.isInstance(request))\n                            return [2, next(args)];\n                        headers = request.headers;\n                        userAgent = ((_a = context === null || context === void 0 ? void 0 : context.userAgent) === null || _a === void 0 ? void 0 : _a.map(escapeUserAgent)) || [];\n                        return [4, options.defaultUserAgentProvider()];\n                    case 1:\n                        defaultUserAgent = (_c.sent()).map(escapeUserAgent);\n                        customUserAgent = ((_b = options === null || options === void 0 ? void 0 : options.customUserAgent) === null || _b === void 0 ? void 0 : _b.map(escapeUserAgent)) || [];\n                        sdkUserAgentValue = __spreadArray(__spreadArray(__spreadArray([], __read(defaultUserAgent), false), __read(userAgent), false), __read(customUserAgent), false).join(SPACE);\n                        normalUAValue = __spreadArray(__spreadArray([], __read(defaultUserAgent.filter(function (section) { return section.startsWith(\"aws-sdk-\"); })), false), __read(customUserAgent), false).join(SPACE);\n                        if (options.runtime !== \"browser\") {\n                            if (normalUAValue) {\n                                headers[X_AMZ_USER_AGENT] = headers[X_AMZ_USER_AGENT]\n                                    ? \"\".concat(headers[USER_AGENT], \" \").concat(normalUAValue)\n                                    : normalUAValue;\n                            }\n                            headers[USER_AGENT] = sdkUserAgentValue;\n                        }\n                        else {\n                            headers[X_AMZ_USER_AGENT] = sdkUserAgentValue;\n                        }\n                        return [2, next(__assign(__assign({}, args), { request: request }))];\n                }\n            });\n        }); };\n    };\n};\nvar escapeUserAgent = function (_a) {\n    var _b = __read(_a, 2), name = _b[0], version = _b[1];\n    var prefixSeparatorIndex = name.indexOf(\"/\");\n    var prefix = name.substring(0, prefixSeparatorIndex);\n    var uaName = name.substring(prefixSeparatorIndex + 1);\n    if (prefix === \"api\") {\n        uaName = uaName.toLowerCase();\n    }\n    return [prefix, uaName, version]\n        .filter(function (item) { return item && item.length > 0; })\n        .map(function (item) { return item === null || item === void 0 ? void 0 : item.replace(UA_ESCAPE_REGEX, \"_\"); })\n        .join(\"/\");\n};\nexport var getUserAgentMiddlewareOptions = {\n    name: \"getUserAgentMiddleware\",\n    step: \"build\",\n    priority: \"low\",\n    tags: [\"SET_USER_AGENT\", \"USER_AGENT\"],\n    override: true,\n};\nexport var getUserAgentPlugin = function (config) { return ({\n    applyToStack: function (clientStack) {\n        clientStack.add(userAgentMiddleware(config), getUserAgentMiddlewareOptions);\n    },\n}); };\n"]},"metadata":{},"sourceType":"module"}